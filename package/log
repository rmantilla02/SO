# Este script es una biblioteca. Para invocarla use 'source log.sh'

# Guarde el nombre del log en la variable LOGFILE.
if [ ! -v LOGFILE ]; then LOGFILE=log; else LOGFILE+=".log"; fi

# AÃ±ade un registro al log de la forma "[yyyy-mm-dd hh:mm:ss] <args>" donde args son los argumentos de la funcion.
function log() {
    if [ ! -v DIRCONF ] || [ ! -d $DIRCONF ]; then return; fi
    echo [$(date "+%F %T")] "$@" >> $DIRCONF/$LOGFILE
}

function truncate() {
    # n es el primer argumento de truncate, o 500 por default.
    local n=${1:-500}
    tmp=$(mktemp)
    tail $DIRCONF/$LOGFILE -n $n > tmp
    mv tmp $DIRCONF/$LOGFILE
}
